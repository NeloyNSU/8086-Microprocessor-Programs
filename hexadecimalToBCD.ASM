;Program For Conversion of Hex to BCD
;
;									CAUTION: 
;										A LOT OF DECORATION HAS BEEN DONE

ASSUME CS:CODE,DS:DATA,SS:STACK
INCLUDE IO.H

STACK SEGMENT
	DW 10 DUP(0)
	TOP LABEL WORD
STACK ENDS

DATA SEGMENT
	PROMPT DB 10,"		16BIT HEXADECIMAL : ",0
	MSG1 DB 10,"		BINARY : ",0
	MSG2 DB 10,"		DECIMAL : ",0
	ALERT DB 10,"		INVALID INPUT! TRY AGAIN",0
	NXT DB 10," ",0
	O DB "1",0
	Z DB "0",0
	HTAB DB 09H,0AH,0BH,0CH,0DH,0EH,0FH;09H FOR CORRECTION ONLY
	ANS DB 6 DUP(0)
DATA ENDS

CODE SEGMENT
START:
	MOV AX,DATA
	MOV DS,AX
	MOV AX,STACK
	MOV SS,AX
	LEA SP,TOP
	

AGAIN:
	MOV CX,0004H
	OUTPUT NXT
	OUTPUT PROMPT
NEXT:
	MOV AH,01H
	INT 21H
	
	CMP AL,46H
	JA DO
	JMP SKP
DO:
	OUTPUT NXT
	OUTPUT ALERT
	JMP AGAIN
SKP:
	CMP AL,41H
	JB SKIP
	AND AL,0FH
	LEA BX,HTAB
	XLATB
	JMP GO
SKIP:
	AND AL,0FH
GO:
	PUSH CX
	MOV CL,04H
	SHL DX,CL
	POP CX
	ADD DL,AL
	LOOP NEXT
	
	MOV AX,DX
	OUTPUT NXT
	OUTPUT MSG1
	
;	DISPLAY IN BINARY
	MOV CX,0010H
POOL:
	SHL DX,1
	JC ONE
	OUTPUT Z
	JMP DOWN
ONE:
	OUTPUT O
DOWN:
	LOOP POOL
	
	OUTPUT NXT
	
;	DISPLAY DECIMAL
	OUTPUT MSG2
	ITOA ANS,AX
	OUTPUT ANS
	OUTPUT NXT
	
	MOV AH,4CH
	INT 21H
CODE ENDS
END START